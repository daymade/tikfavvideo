# 抖音收藏夹导出工具

一个用于导出抖音收藏夹视频信息的 Tampermonkey 用户脚本。

## 功能特性

- 🎯 **智能页面检测**：自动识别收藏夹列表页面和具体收藏夹页面
- 🔄 **自动滚动加载**：智能滚动加载所有视频，支持抖音的虚拟滚动
- 📊 **完整数据导出**：导出视频ID、标题、链接、封面、点赞数等信息
- 📋 **多格式输出**：提供结构化JSON和简化URL列表两种格式
- 🛡️ **稳定可靠**：不依赖随机CSS类名，使用语义化属性定位元素

## 安装方法

1. 安装 [Tampermonkey](https://tampermonkey.net/) 浏览器扩展
2. 复制 `tikfavvideo.js` 文件内容
3. 在 Tampermonkey 中创建新脚本，粘贴代码
4. 保存并启用脚本

## 使用方法

### 1. 进入抖音收藏夹

访问抖音个人主页的收藏夹页面：
```
https://www.douyin.com/user/self?showSubTab=favorite_folder&showTab=favorite_collection
```

### 2. 选择具体收藏夹

- 如果在收藏夹列表页面，脚本会显示所有可用的收藏夹
- 点击想要导出的收藏夹进入具体收藏夹页面

### 3. 执行导出

在具体收藏夹页面按 **Shift+S** 触发导出功能

### 4. 等待完成

脚本会自动：
- 检测页面状态
- 滚动加载所有视频
- 提取视频信息
- 复制结果到剪贴板

## 输出格式

导出的数据包含两种格式：

### 结构化数据
```json
{
  "收藏夹信息": {
    "名称": "123",
    "视频总数": 23,
    "用户昵称": "xxxx",
    "用户ID": "未知",
    "导出时间": "2025/6/22 18:04:20"
  },
  "视频列表": [
    {
      "序号": 1,
      "视频ID": "7322323500700601640",
      "标题": "视频标题",
      "链接": "https://www.douyin.com/video/7322323500700601640",
      "封面": "封面图片URL",
      "点赞数": "8.8万"
    }
  ]
}
```

### 简化URL列表
```json
{
  "简化URL列表": {
    "说明": "以下是纯URL列表，适合复制到在线工具使用",
    "格式": "逗号+换行分隔",
    "链接": "https://www.douyin.com/video/1,\nhttps://www.douyin.com/video/2"
  }
}
```

## 错误处理

脚本会智能检测各种页面状态并给出相应提示：

### 收藏夹列表页面
如果在收藏夹列表页面运行脚本，会显示：
```
📁 您当前在收藏夹列表页面，发现以下收藏夹：

📂 收藏夹 "123" - 29个视频
📂 收藏夹 "456" - 0个视频

💡 操作说明：
1. 点击任意收藏夹进入具体收藏夹页面
2. 等待页面加载完成，确认显示视频列表
3. 再次按 Shift+S 导出该收藏夹的视频数据

⚠️ 注意：必须进入具体收藏夹才能导出数据
```

### 空收藏夹
```
❌ 收藏夹为空或页面未加载完成

请确认：
1. 当前收藏夹中有视频内容
2. 页面已完全加载
3. 您已进入具体的收藏夹而不是收藏夹列表页面
```

### 非收藏夹页面
```
❌ 请先进入收藏夹页面

点击确定将跳转到收藏夹页面
```

## 技术特性

### 智能滚动算法
- 自动检测可滚动的父容器
- 使用多种滚动方法：容器滚动、键盘事件、鼠标滚轮
- 查找并点击"加载更多"按钮
- 支持虚拟滚动和无限滚动

### 稳定的元素定位
- 使用 `data-e2e` 等语义化属性
- 避免依赖随机生成的CSS类名
- 多重备选方案确保兼容性

### 数据验证
- 过滤无效视频条目
- 验证视频ID和URL格式
- 确保数据完整性

## 版本历史

### v0.3.0
- 重写智能滚动算法，支持抖音虚拟滚动
- 改进页面状态检测逻辑
- 修复收藏夹名称识别问题
- 增强错误处理和用户提示

### v0.2.0
- 添加页面状态检测
- 支持收藏夹列表页面提示
- 优化视频计数和筛选逻辑

### v0.1.0
- 基础视频导出功能
- 自动滚动加载
- JSON格式输出

## 故障排除

### 滚动不工作
1. 确保页面完全加载
2. 尝试手动滚动几次再运行脚本
3. 检查是否在正确的收藏夹页面

### 视频数量不正确
1. 等待页面滚动到底部显示"暂时没有更多"
2. 手动刷新页面重试
3. 检查网络连接

### 收藏夹名称显示错误
1. 确保在具体收藏夹页面而非列表页面
2. 检查收藏夹是否有自定义名称
3. 刷新页面重试

## 注意事项

1. **合法使用**：仅用于个人收藏内容的备份，请遵守相关法律法规
2. **网络环境**：需要稳定的网络连接，中国用户可能需要多次尝试
3. **页面状态**：确保在正确的收藏夹页面使用脚本
4. **数据备份**：导出的数据建议及时保存到本地文件

## 许可证

MIT License - 允许自由使用、修改和分发